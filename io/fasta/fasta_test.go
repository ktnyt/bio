package fasta_test

import (
	"bytes"
	"fmt"
	"testing"

	"github.com/ktnyt/bio/io/fasta"
)

var testString = `>sp|P0CY46|EGFR_APIME Epidermal growth factor receptor OS=Apis mellifera OX=7460 GN=Egfr PE=2 SV=1
MYNNYNLCHIRTINWEEIITGPSAMYSYVYNFTSPERACTPCDKSCEQGCWGEGPENCQK
YSKTNCSPQCWQGRCFGPNPRECCHLFCAGGCTGPKQSDCIACKNFFDDGVCTQECPPMQ
KYNPTTYSWEPNPDGKYAYGATCVRRCPEHLLKDNGACVRSCPPKKKALNGECVPCDGPC
PKTCKGVEKVHSGNIDSFKDCTIIEGSITILDQSFQGFQHVYRNFSFGKRYEKMHPDKLE
VFSTLKEITGFLNIQGDHKDFKNLSYFRNLEVIGGRTLTEYFASLYVVKTSLVSFGLSSL
KKIYSGSIAILENKNLCYAQSINWTRIKKSSEHESLLSNNRNESECIKDGLVCDEQCSDE
GCWGPGPAQCLSCKNFILGNDCLQDCTAPGIYQADEKTCKVCHEECDGSCIGPNTDHCKK
CKHARDGPFCVPECPASKYNDNGVCKSCHGNCVGGCEGPENNIGPNGCHSCDKAILNDHV
PEGCLQKKESCPDGYYYEWVSPLEQGPLKPLASKAVCRKCHSRCKKCTGYGFHEHVCQEC
TKYKRGEQCEDECPADYFADANKLCIPCFSECRGCFGPGPNQCYKCRNYKIYIDEDTDGN
TTSFNCTETCTPEYPHKIFNPDSEPYCSLETAGLIENELQPAILAGVAVFALAFLVVAAI
IMYFWRVRAKAKENTVKMTMALTGLDDNEPLRPTGVKPNLAKLRIIKEEEMRKGGILGYG
AFGNVYKGVWVPEGENVKIPVAIKVLHDGTGANTSKEFLDEAYIMASVEHPNLLQLLAVC
MTSQMMLVTQLMPLGCLLDFVRRFKDKIGSKALLNWCTQIARGMAYLEERRLVHRDLAAR
NVLVQTPNCVKITDFGLAKLLDINEEQYKAAGGKMPIKWLALECIQHRVFTHKSDVWAFG
VTIWEVLTYGGRPYENVPARNVPELLEKGERLPQPAICTIDVYMIMIKCWMLDAESRPSF
KELAEDFAKMSRDPGRYLAIKGDKYMRLPSYTLQDEKEMIRNLASAMDGPEALVDADEYL
QPKSRAPIPPGLSASSTSGSPPNTPVKPCWPNGKPLAADSPTPQNQQNWDRELLRYGANH
RNGNVSSHEPGNSAQHGHYTPPNGHCGHVVGSDSTASRYCSDPLKMIDVRDCDVTDDCFD
GEVNSAHQQAQVGNLKLDLPLDEDDYLMPSPQLPTNTTQYMDLIGDSKPTEMEPKRVNNG
YRKYPEFLTIQGKTSLDNPEYIMSQDEGPLTPQTIGIPTPDLEKVLTNGTFGSQVRQRSS
EEESDHEYYNDFDRLERELQPLKPLRKNETTV
>sp|P13387|EGFR_CHICK Epidermal growth factor receptor (Fragment) OS=Gallus gallus OX=9031 GN=EGFR PE=1 SV=1
MGVRSPLSASGPRGAAVLVLLLLGVALCSAVEEKKVCQGTNNKLTQLGHVEDHFTSLQRM
YNNCEVVLSNLEITYVEHNRDLTFLKTIQEVAGYVLIALNMVDVIPLENLQIIRGNVLYD
NSFALAVLSNYHMNKTQGLRELPMKRLSEILNGGVKISNNPKLCNMDTVLWNDIIDTSRK
PLTVLDFASNLSSCPKCHPNCTEDHCWGAGEQNCQTLTKVICAQQCSGRCRGKVPSDCCH
NQCAAGCTGPRESDCLACRKFRDDATCKDTCPPLVLYNPTTYQMDVNPEGKYSFGATCVR
ECPHNYVVTDHGSCVRSCNTDTYEVEENGVRKCKKCDGLCSKVCNGIGIGELKGILSINA
TNIDSFKNCTKINGDVSILPVAFLGDAFTKTLPLDPKKLDVFRTVKEISGFLLIQAWPDN
ATDLYAFENLEIIRGRTKQHGQYSLAVVNLKIQSLGLRSLKEISDGDIAIMKNKNLCYAD
TMNWRSLFATQSQKTKIIQNRNKNDCTADRHVCDPLCSDVGCWGPGPFHCFSCRFFSRQK
ECVKQCNILQGEPREFERDSKCLPCHSECLVQNSTAYNTTCSGPGPDHCMKCAHFIDGPH
CVKACPAGVLGENDTLVWKYADANAVCQLCHPNCTRGCKGPGLEGCPNGSKTPSIAAGVV
GGLLCLVVVGLGIGLYLRRRHIVRKRTLRRLLQERELVEPLTP
>sp|P04412|EGFR_DROME Epidermal growth factor receptor OS=Drosophila melanogaster OX=7227 GN=Egfr PE=1 SV=3
MLLRRRNGPCPFPLLLLLLAHCICIWPASAARDRYARQNNRQRHQDIDRDRDRDRFLYRS
SSAQNRQRGGANFALGLGANGVTIPTSLEDKNKNEFVKGKICIGTKSRLSVPSNKEHHYR
NLRDRYTNCTYVDGNLKLTWLPNENLDLSFLDNIREVTGYILISHVDVKKVVFPKLQIIR
GRTLFSLSVEEEKYALFVTYSKMYTLEIPDLRDVLNGQVGFHNNYNLCHMRTIQWSEIVS
NGTDAYYNYDFTAPERECPKCHESCTHGCWGEGPKNCQKFSKLTCSPQCAGGRCYGPKPR
ECCHLFCAGGCTGPTQKDCIACKNFFDEAVSKEECPPMRKYNPTTYVLETNPEGKYAYGA
TCVKECPGHLLRDNGACVRSCPQDKMDKGGECVPCNGPCPKTCPGVTVLHAGNIDSFRNC
TVIDGNIRILDQTFSGFQDVYANYTMGPRYIPLDPERREVFSTVKEITGYLNIEGTHPQF
RNLSYFRNLETIHGRQLMESMFAALAIVKSSLYSLEMRNLKQISSGSVVIQHNRDLCYVS
NIRWPAIQKEPEQKVWVNENLRADLCEKNGTICSDQCNEDGCWGAGTDQCLTCKNFNFNG
TCIADCGYISNAYKFDNRTCKICHPECRTCNGAGADHCQECVHVRDGQHCVSECPKNKYN
DRGVCRECHATCDGCTGPKDTIGIGACTTCNLAIINNDATVKRCLLKDDKCPDGYFWEYV
HPQEQGSLKPLAGRAVCRKCHPLCELCTNYGYHEQVCSKCTHYKRREQCETECPADHYTD
EEQRECFQRHPECNGCTGPGADDCKSCRNFKLFDANETGPYVNSTMFNCTSKCPLEMRHV
NYQYTAIGPYCAASPPRSSKITANLDVNMIFIITGAVLVPTICILCVVTYICRQKQKAKK
ETVKMTMALSGCEDSEPLRPSNIGANLCKLRIVKDAELRKGGVLGMGAFGRVYKGVWVPE
GENVKIPVAIKELLKSTGAESSEEFLREAYIMASEEHVNLLKLLAVCMSSQMMLITQLMP
LGCLLDYVRNNRDKIGSKALLNWSTQIAKGMSYLEEKRLVHRDLAARNVLVQTPSLVKIT
DFGLAKLLSSDSNEYKAAGGKMPIKWLALECIRNRVFTSKSDVWAFGVTIWELLTFGQRP
HENIPAKDIPDLIEVGLKLEQPEICSLDIYCTLLSCWHLDAAMRPTFKQLTTVFAEFARD
PGRYLAIPGDKFTRLPAYTSQDEKDLIRKLAPTTDGSEAIAKPDDYLQPKAAPGPSHRTD
CTDEMPKLNRYCKDPSNKNSSTGDDERDSSAREVGVGNLRLDLPVDEDDYLMPTCQPGPN
NNNNMNNPNQNNMAAVGVAAGYMDLIGVPVSVDNPEYLLNAQTLGVGESPIPTQTIGIPV
MGGPGTMEVKVPMPGSEPTSSDHEYYNDTQRELQPLHRNRNTETRV
>sp|P00533|EGFR_HUMAN Epidermal growth factor receptor OS=Homo sapiens OX=9606 GN=EGFR PE=1 SV=2
MRPSGTAGAALLALLAALCPASRALEEKKVCQGTSNKLTQLGTFEDHFLSLQRMFNNCEV
VLGNLEITYVQRNYDLSFLKTIQEVAGYVLIALNTVERIPLENLQIIRGNMYYENSYALA
VLSNYDANKTGLKELPMRNLQEILHGAVRFSNNPALCNVESIQWRDIVSSDFLSNMSMDF
QNHLGSCQKCDPSCPNGSCWGAGEENCQKLTKIICAQQCSGRCRGKSPSDCCHNQCAAGC
TGPRESDCLVCRKFRDEATCKDTCPPLMLYNPTTYQMDVNPEGKYSFGATCVKKCPRNYV
VTDHGSCVRACGADSYEMEEDGVRKCKKCEGPCRKVCNGIGIGEFKDSLSINATNIKHFK
NCTSISGDLHILPVAFRGDSFTHTPPLDPQELDILKTVKEITGFLLIQAWPENRTDLHAF
ENLEIIRGRTKQHGQFSLAVVSLNITSLGLRSLKEISDGDVIISGNKNLCYANTINWKKL
FGTSGQKTKIISNRGENSCKATGQVCHALCSPEGCWGPEPRDCVSCRNVSRGRECVDKCN
LLEGEPREFVENSECIQCHPECLPQAMNITCTGRGPDNCIQCAHYIDGPHCVKTCPAGVM
GENNTLVWKYADAGHVCHLCHPNCTYGCTGPGLEGCPTNGPKIPSIATGMVGALLLLLVV
ALGIGLFMRRRHIVRKRTLRRLLQERELVEPLTPSGEAPNQALLRILKETEFKKIKVLGS
GAFGTVYKGLWIPEGEKVKIPVAIKELREATSPKANKEILDEAYVMASVDNPHVCRLLGI
CLTSTVQLITQLMPFGCLLDYVREHKDNIGSQYLLNWCVQIAKGMNYLEDRRLVHRDLAA
RNVLVKTPQHVKITDFGLAKLLGAEEKEYHAEGGKVPIKWMALESILHRIYTHQSDVWSY
GVTVWELMTFGSKPYDGIPASEISSILEKGERLPQPPICTIDVYMIMVKCWMIDADSRPK
FRELIIEFSKMARDPQRYLVIQGDERMHLPSPTDSNFYRALMDEEDMDDVVDADEYLIPQ
QGFFSSPSTSRTPLLSSLSATSNNSTVACIDRNGLQSCPIKEDSFLQRYSSDPTGALTED
SIDDTFLPVPEYINQSVPKRPAGSVQNPVYHNQPLNPAPSRDPHYQDPHSTAVGNPEYLN
TVQPTCVNSTFDSPAHWAQKGSHQISLDNPDYQQDFFPKEAKPNGIFKGSTAENAEYLRV
APQSSEFIGA
>sp|P55245|EGFR_MACMU Epidermal growth factor receptor OS=Macaca mulatta OX=9544 GN=EGFR PE=2 SV=2
MRPSGTAGAALLALLAALCPASRALEEKKVCQGTSNKLTQLGTFEDHFLSLQRMFNNCEV
VLGNLEITYVQRNYDLSFLKTIQEVAGYVLIALNTVERIPLENLQIIRGNMYYENSYALA
VLSNYDANKTGLKELPMRNLQEILHGAVRFSNNPALCNVESIQWRDIVSSEFLSNMSMDF
QNHLGSCQKCDPSCPNGSCWGAGEENCQKLTKIICAQQCSGRCRGKSPSDCCHNQCAAGC
TGPRESDCLVCRKFRDEATCKDTCPPLMLYNPTTYQMDVNPEGKYSFGATCVKKCPRNYV
VTDHGSCVRACGADSYEMEEDGVRKCKKCEGPCRKVCNGIGIGEFKDTLSINATNIKHFK
NCTSISGDLHILPVAFRGDSFTHTPPLDPQELDILKTVKEITGFLLIQAWPENRTDLHAF
ENLEIIRGRTKQHGQFSLAVVSLNITSLGLRSLKEISDGDVIISGNKNLCYANTINWKKL
FGTSSQKTKIISNRGENSCKATGQVCHALCSPEGCWGPEPRDCVSCQNVSRGRECVDKCN
VLEGEPREFVENSECIQCHPECLPQVMNITCTGRGPDNCIQCAHYIDGPHCVKTCPAGVM
GENNTLVWKYADAGHVCHLCHPNCTYGCTGPGLEGCARNGPKIPSIATGMVGALLLLLVV
ALGIGLFMRRRHIVRKRTLRRLLQERELVEPLTPSGEAPNQALLRILKETEFKKIKVLGS
GAFGTVYKGLWIPEGEKVKIPVAIKELREATSPKANKEILDEAYVMASVDNPHVCRLLGI
CLTSTVQLITQLMPFGCLLDYVREHKDNIGSQYLLNWCVQIAKGMNYLEDRRLVHRDLAA
RNVLVKTPQHVKITDFGLAKLLGAEEKEYHAEGGKVPIKWMALESILHRIYTHQSDVWSY
GVTVWELMTFGSKPYDGIPASEISSILEKGERLPQPPICTIDVYMIMVKCWMIDADSRPK
FRELIIEFSKMARDPQRYLVIQGDERMHLPSPTDSNFYRALMDEEDMDDVVDADEYLIPQ
QGFFSSPSTSRTPLLSSLSATSNNSTVACIDRNGLQSCPIKEDSFLQRYSSDPTGALTED
SIDDTFLPVPEYINQSVPKRPAGSVQNPVYHNQPLNPAPSRDPHYQDPHSTAVGNPEYLN
TVQPTCVNSTFDSPAHWAQKGSHQISLDNPDYQQDFFPKEAKPNGIFKGSTAENAEYLRV
APQSSEFIGA
>sp|Q01279|EGFR_MOUSE Epidermal growth factor receptor OS=Mus musculus OX=10090 GN=Egfr PE=1 SV=1
MRPSGTARTTLLVLLTALCAAGGALEEKKVCQGTSNRLTQLGTFEDHFLSLQRMYNNCEV
VLGNLEITYVQRNYDLSFLKTIQEVAGYVLIALNTVERIPLENLQIIRGNALYENTYALA
ILSNYGTNRTGLRELPMRNLQEILIGAVRFSNNPILCNMDTIQWRDIVQNVFMSNMSMDL
QSHPSSCPKCDPSCPNGSCWGGGEENCQKLTKIICAQQCSHRCRGRSPSDCCHNQCAAGC
TGPRESDCLVCQKFQDEATCKDTCPPLMLYNPTTYQMDVNPEGKYSFGATCVKKCPRNYV
VTDHGSCVRACGPDYYEVEEDGIRKCKKCDGPCRKVCNGIGIGEFKDTLSINATNIKHFK
YCTAISGDLHILPVAFKGDSFTRTPPLDPRELEILKTVKEITGFLLIQAWPDNWTDLHAF
ENLEIIRGRTKQHGQFSLAVVGLNITSLGLRSLKEISDGDVIISGNRNLCYANTINWKKL
FGTPNQKTKIMNNRAEKDCKAVNHVCNPLCSSEGCWGPEPRDCVSCQNVSRGRECVEKCN
ILEGEPREFVENSECIQCHPECLPQAMNITCTGRGPDNCIQCAHYIDGPHCVKTCPAGIM
GENNTLVWKYADANNVCHLCHANCTYGCAGPGLQGCEVWPSGPKIPSIATGIVGGLLFIV
VVALGIGLFMRRRHIVRKRTLRRLLQERELVEPLTPSGEAPNQAHLRILKETEFKKIKVL
GSGAFGTVYKGLWIPEGEKVKIPVAIKELREATSPKANKEILDEAYVMASVDNPHVCRLL
GICLTSTVQLITQLMPYGCLLDYVREHKDNIGSQYLLNWCVQIAKGMNYLEDRRLVHRDL
AARNVLVKTPQHVKITDFGLAKLLGAEEKEYHAEGGKVPIKWMALESILHRIYTHQSDVW
SYGVTVWELMTFGSKPYDGIPASDISSILEKGERLPQPPICTIDVYMIMVKCWMIDADSR
PKFRELILEFSKMARDPQRYLVIQGDERMHLPSPTDSNFYRALMDEEDMEDVVDADEYLI
PQQGFFNSPSTSRTPLLSSLSATSNNSTVACINRNGSCRVKEDAFLQRYSSDPTGAVTED
NIDDAFLPVPEYVNQSVPKRPAGSVQNPVYHNQPLHPAPGRDLHYQNPHSNAVGNPEYLN
TAQPTCLSSGFNSPALWIQKGSHQMSLDNPDYQQDFFPKETKPNGIFKGPTAENAEYLRV
APPSSEFIGA
`

func TestFastaIO(t *testing.T) {
	r := bytes.NewBufferString(testString)
	b := new(bytes.Buffer)

	s := fasta.NewScanner(r)
	w := fasta.NewWriterWrap(b, 60)

	for s.Scan() {
		err := w.WriteSeq(s.Seq())
		if err != nil {
			t.Error(err)
		}
	}

	if testString != b.String() {
		fmt.Println(b.String())
		t.Error("input and output strings do not match")
	}
}
